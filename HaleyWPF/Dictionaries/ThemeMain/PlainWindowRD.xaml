<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:bc="clr-namespace:Haley.WPF.Controls"
    xmlns:ul="clr-namespace:Haley.Utils"
    xmlns:ml="clr-namespace:Haley.Models">

    <ResourceDictionary.MergedDictionaries>
        <ml:CommonDictionary Source="pack://application:,,,/Haley.WPF;component/Dictionaries/haleyBase.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <Style TargetType="{x:Type bc:PlainWindow}">
        <Setter Property="Margin" Value="5"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Background" Value="#99888D90"/>
        <Setter Property="ml:Icon.DefaultColor" Value="White"/>
        <Setter Property="ResizeMode" Value="CanResize"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type bc:PlainWindow}">
                    <ControlTemplate.Resources>
                        <ResourceDictionary>
                            <DataTemplate x:Key="defaultHeaderTemplate">
                                <Grid x:Name="grdDefaultHeader">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="{Binding ElementName=grdDefaultHeader,Path=ActualHeight}"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="1" Text="{Binding RelativeSource={RelativeSource TemplatedParent},Path=Title}"/>
                                </Grid>
                            </DataTemplate>
                        </ResourceDictionary>
                    </ControlTemplate.Resources>
                    
                        <Border Margin="{TemplateBinding Margin}" Background="{TemplateBinding Background}" CornerRadius="{TemplateBinding CornerRadius}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="6" ShadowDepth="0"/>
                            </Border.Effect>

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="{Binding RelativeSource={RelativeSource TemplatedParent},Path=HeaderHeight}"/>
                                    <RowDefinition/>
                                <RowDefinition Height="{Binding RelativeSource={RelativeSource TemplatedParent},Path=FooterHeight}"/>
                                </Grid.RowDefinitions>

                                <!--Header-->
                                <Border x:Name="PART_header_holder" Background="Transparent">
                                    <Grid x:Name="grdHeader" Background="Transparent">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="MouseLeftButtonDown" >
                                                <i:InvokeCommandAction Command="{x:Static ul:AdditionalCommands.ExecuteAction}" CommandParameter="DragMove"  />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="10"/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="10"/>
                                        </Grid.ColumnDefinitions>

                                        <Grid x:Name="grdControlBox" VerticalAlignment="Top" Grid.Column="2" Height="27" Margin="4" >
                                        <Grid.Resources>
                                            <ResourceDictionary>
                                                <Style x:Key="controlButtonStyle" TargetType="{x:Type bc:ImageButton}">
                                                    <Setter Property="ml:Icon.DefaultColor" Value="{Binding RelativeSource={RelativeSource TemplatedParent},Path=(ml:Icon.DefaultColor)}"/>
                                                    <Setter Property="ml:Icon.HoverColor" Value="{Binding RelativeSource={RelativeSource TemplatedParent},Path=(ml:Icon.HoverColor)}"/>
                                                    <Setter Property="Margin" Value="3"/>
                                                </Style>
                                            </ResourceDictionary>
                                        </Grid.Resources>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="{Binding ElementName=grdControlBox,Path=ActualHeight}"/>
                                                <ColumnDefinition Width="{Binding ElementName=grdControlBox,Path=ActualHeight}"/>
                                                <ColumnDefinition Width="{Binding ElementName=grdControlBox,Path=ActualHeight}"/>
                                            </Grid.ColumnDefinitions>
                                        <bc:ImageButton x:Name="PART_btn_minimize"  ml:Icon.Default="{StaticResource line}"  Style="{StaticResource controlButtonStyle}" CommandParameter="Min" Command="{x:Static ul:AdditionalCommands.ExecuteAction}"/>
                                        <bc:ImageButton x:Name="PART_btn_maximize" Grid.Column="1"  ml:Icon.Default="{StaticResource box}" Style="{StaticResource controlButtonStyle}"  CommandParameter="Max" Command="{x:Static ul:AdditionalCommands.ExecuteAction}"/>
                                        <bc:ImageButton x:Name="PART_btn_close" Grid.Column="2"  ml:Icon.Default="{StaticResource close_circle}" Style="{StaticResource controlButtonStyle}"  CommandParameter="Close" Command="{x:Static ul:AdditionalCommands.ExecuteAction}"/>
                                        </Grid>

                                        <ContentControl x:Name="PART_header" Grid.Column="1"/>
                                    </Grid>
                                </Border>

                                <!--Footer-->
                                <Border x:Name="PART_footer_holder" Grid.Row="2">
                                    <ContentControl x:Name="PART_footer"/>
                                </Border>

                                <!--Content Presenter-->
                                <ContentPresenter Grid.Row="1"/>

                            </Grid>
                        </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
